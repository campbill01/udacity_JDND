<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
	<title>WebSocket Demo</title>
</head>
<body>
    <H1>WebSocket Demo</H1>
    <div >
        <!-- method, action ?? put messaging here-->
        <form>
            <input type="text" id="textInput">
            <input type="submit" id="textSubmit" value="Submit message">
        </form>
    </div>
    <p style="margin:30px"></p>
    <div>
        <!-- Put connect/disconnect here-->
        <form>
            <input type="submit" id="connect" value="Connect">
            <input type="submit" id="disconnect" value="Disconnect">
        </form>
    </div>
    <script type="text/javascript">
        var active;
        var client;
        var connectButton = document.getElementById("connect");
        var disconnectButton = document.getElementById("disconnect");
        var messageButton = document.getElementById("textSubmit");
        var messageText = document.getElementById("textInput");

        connectButton.addEventListener("click", function(){
            var sock = new SockJS('http://localhost:8080/websocket-demo');
            var client = Stomp.over(sock);
             active = client.connect();
            //console.log(active);
            return active;
        });

        disconnectButton.addEventListener("click", function(){
            //var sock = new SockJS('http://localhost:8080/websocket-demo');
            //var client = Stomp.over(sock);
            //var active = client.connect();
            var deactive = active.disconnect();
            
            return deactive;
        });

        messageButton.addEventListener("click", function(){
            active.send("/topic", {priority: 9}, messageText)
        });
    </script>
</body>
</html>